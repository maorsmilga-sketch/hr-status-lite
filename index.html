<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>עדכון סטטוס</title>
<style>
/* ... (כל ה-CSS הקודם נשאר זהה עד סוף הקובץ) ... */

  /* פופ-אפ מרכזי */
  .popup {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.4);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
  }
  .popup.show { display: flex; animation: fadeIn 0.2s ease; }
  .popup-box {
    background: #fff;
    padding: 30px 50px;
    border-radius: 14px;
    box-shadow: 0 8px 24px rgba(0,0,0,.25);
    font-size: 20px;
    color: #2E7D32;
    font-weight: bold;
    text-align: center;
    animation: scaleUp 0.25s ease;
  }
  @keyframes scaleUp { from { transform: scale(0.8); opacity:0 } to { transform: scale(1); opacity:1 } }
  @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
</style>
</head>
<body>
<header>
  <img src="logo.png" alt="לוגו" style="width:110px;height:auto;margin-bottom:5px;display:block;margin-left:auto;margin-right:auto;">
  <h1>עדכון סטטוס</h1>
</header>

<div id="status" class="statusbar">טוען…</div>

<div class="wrap">
  <!-- התוכן הקיים שלך נשאר זהה בדיוק -->
  <label>קבוצה:
    <select id="group"></select>
  </label>
  <label>שם:
    <select id="user"></select>
  </label>
  <div class="hint">המערכת תזכור את הבחירה לפעם הבאה.</div>

  <label>סטטוס:</label>
  <div id="statusButtons" class="status-grid"></div>

  <label>התחלה:</label>
  <div style="display:flex;gap:8px">
    <input type="datetime-local" id="start_time" />
    <button id="start_now" type="button" class="secondary" style="width:40%">התחל מעכשיו</button>
  </div>

  <label>סיום (אופציונלי):</label>
  <input type="datetime-local" id="end_time" />

  <button id="save">שמור</button>
</div>

<!-- טוסט קיים -->
<div id="toast" class="toast">עודכן</div>

<!-- פופ-אפ חדש -->
<div id="popup" class="popup">
  <div class="popup-box">עודכן בהצלחה</div>
</div>

<script src="config.js"></script>
<script>
/* -------- כל ה-JS הקיים נשמר כמות שהוא -------- */

/* תוספת קטנה אחרי showToast */
const popup = document.getElementById('popup');
function showPopup(){
  popup.classList.add('show');
  setTimeout(()=> popup.classList.remove('show'), 1500);
}

/* בתוך saveB.onclick אחרי showToast */
saveB.onclick = async ()=>{
  if (!selectedStatusCode){
    setBar('בחר סטטוס לפני שמירה', false);
    return;
  }
  saveProfile();
  setBar('שומר…');
  try{
    await apiCreateEvent({
      user: uSel.value,
      group: gSel.value,
      status_code: selectedStatusCode,
      starts_at: start.value ? new Date(start.value).toISOString() : new Date().toISOString(),
      ends_at: endI.value ? new Date(endI.value).toISOString() : '',
      source: 'user'
    });
    setBar('עודכן בהצלחה ✔', true);
    showToast('עודכן');
    showPopup(); // <== חלון קופץ קטן באמצע המסך
  } catch(err){
    setBar('שגיאה בשמירה: ' + err.message, false);
    alert('שגיאה: ' + err.message);
  }
};
</script>
</body>
</html>
